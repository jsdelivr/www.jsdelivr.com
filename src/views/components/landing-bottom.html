<link rel="ractive" href="../components/new-infographic-banner.html" name="c-new-infographic-banner">
<link rel="ractive" href="./stats-table.html" name="c-stats-table">
<link rel="ractive" href="./slider.html" name="c-slider">
<link rel="ractive" href="./slide.html" name="c-slide">
<!-- Commenting this out while we switch to another API -->
<!-- <link rel="ractive" href="./rum.html" name="c-rum"> -->

<div class="c-landing-bottom">
	
	<section class="built-for-production section">
		<div class="container">
			<span>Multi-CDN Global Network</span>
			<h2>Built for production</h2>

			<ul class="features-list">
				<li><a href="/network">
					<img src="{{@shared.assetsHost}}/img/landing/new/built-for-prod/1.svg" alt="">

					<h6>Four CDN<br> & two DNS providers</h6>
				</a></li>
				<li><a href="/network#map">
					<img src="{{@shared.assetsHost}}/img/landing/new/built-for-prod/2.svg" alt="">
						
					<h6>More than 750 points<br> of presence</h6>
				</a></li>
				<li><a href="/network">
					<img src="{{@shared.assetsHost}}/img/landing/new/built-for-prod/3.svg" alt="">
						
					<h6>Low latency "Near China"<br> network</h6>
				</a></li>
				<li><a target="_blank" rel="noopener noreferrer" href="https://www.cdnperf.com">
					<img src="{{@shared.assetsHost}}/img/landing/new/built-for-prod/4.svg" alt="">
						
					<h6>Smart load-balancing<br> and routing</h6>
				</a></li>
				<li><a href="/network#failover">
					<img src="{{@shared.assetsHost}}/img/landing/new/built-for-prod/5.svg" alt="">
						
					<h6>Multi-layer cache<br> and failover</h6>
				</a></li>
				<li><a href="/network">
					<img src="{{@shared.assetsHost}}/img/landing/new/built-for-prod/6.svg" alt="">
						
					<h6>Formal ToS<br> and Privacy Policy</h6>
				</a></li>
			</ul>	
		</div>

		<div class="network-data container-lg">
			<div class="network-data-map">
				<div class="network-data-map-wrap">
					
					<svg width="908" height="428" viewBox="0 0 908 428" fill="none" xmlns="http://www.w3.org/2000/svg">
						<g transform="translate(34, 74)"> 
							<circle r="2" />
							<circle r="2" />
						</g>
						<g transform="translate(66, 146)"> 
							<circle r="2" />
							<circle r="2" />
						</g>
						<g transform="translate(114, 138)"> 
							<circle r="2" />
							<circle r="2" />
						</g>
						<g transform="translate(122, 98)"> 
							<circle r="2" />
							<circle r="2" />
						</g>
						<g transform="translate(218, 130)"> 
							<circle r="2" />
							<circle r="2" />
						</g>
						<g transform="translate(146, 122)"> 
							<circle r="2" />
							<circle r="2" />
						</g>
						<g transform="translate(178, 154)"> 
							<circle r="2" />
							<circle r="2" />
						</g>


						<g transform="translate(266, 290)"> 
							<circle r="2" />
							<circle r="2" />
						</g>
						<g transform="translate(170, 298)"> 
							<circle r="2" />
							<circle r="2" />
						</g>
						<g transform="translate(226, 378)"> 
							<circle r="2" />
							<circle r="2" />
						</g>


						<g transform="translate(386, 130)"> 
							<circle r="2" />
							<circle r="2" />
						</g>
						<g transform="translate(402, 90)"> 
							<circle r="2" />
							<circle r="2" />
						</g>
						<g transform="translate(402, 138)"> 
							<circle r="2" />
							<circle r="2" />
						</g>
						<g transform="translate(418, 98)"> 
							<circle r="2" />
							<circle r="2" />
						</g>
						<g transform="translate(442, 50)"> 
							<circle r="2" />
							<circle r="2" />
						</g>
						<g transform="translate(442, 106)"> 
							<circle r="2" />
							<circle r="2" />
						</g>
						<g transform="translate(466, 114)"> 
							<circle r="2" />
							<circle r="2" />
						</g>


						<g transform="translate(850, 354)"> 
							<circle r="2" />
							<circle r="2" />
						</g>
						<g transform="translate(818, 378)"> 
							<circle r="2" />
							<circle r="2" />
						</g>


						<g transform="translate(794, 226)"> 
							<circle r="2" />
							<circle r="2" />
						</g>
						<g transform="translate(738, 202)"> 
							<circle r="2" />
							<circle r="2" />
						</g>
						<g transform="translate(754, 162)"> 
							<circle r="2" />
							<circle r="2" />
						</g>
						<g transform="translate(794, 138)"> 
							<circle r="2" />
							<circle r="2" />
						</g>

						<g transform="translate(458, 362)"> 
							<circle r="2" />
							<circle r="2" />
						</g>
					</svg>

					<img src="{{@shared.assetsHost}}/img/landing/new/map-blank.svg">

				</div>
			</div>

			<div class="network-data-grid">
				<div>
					<img src="{{@shared.assetsHost}}/img/landing/new/map-icons/1.svg" alt="">
						
					<h3 class="green">1 mil+</h3>
					<p>active oss projects served</p>
				</div>

				<div>
					<img src="{{@shared.assetsHost}}/img/landing/new/map-icons/2.svg" alt="">
						
					<h3 class="green">99.99%</h3>
					<p>cache hit ratio</p>
				</div>

				<div>
					<img src="{{@shared.assetsHost}}/img/landing/new/map-icons/3.svg" alt="">

					<h3>{{ Math.round(requestsPerSecond) }}</h3>
					<span>requests per second</span>
				</div>

				<div>
					<img src="{{@shared.assetsHost}}/img/landing/new/map-icons/4.svg" alt="">
						
					<h3>{{ bandwidth.toFixed(1) }} Mbps</h3>
					<span>bandwidth</span>
				</div>
			</div>

			<div class="text-center">
				<a class="btn-arrow" href="/network#map">
					View our network map
					<img src="{{@shared.assetsHost}}/img/icons/arrow-right.svg">
				</a>
			</div>
		</div>

	</section>

	<section class="dev-friendly section">
		<div class="container-lg">
			<div class="container">
				<h3>Developer Friendly</h3>
				<p>All files from <span>npm</span> and <span>Github</span> available with zero setup</p>
	
				<ul class="features-list">
					<li><a href="/statistics">
						<img src="{{@shared.assetsHost}}/img/landing/new/dev-friendly/1.svg" alt="">
	
						<h6>Usage statistics</h6>
					</a></li>
					<li><a href="/features#combine">
						<img src="{{@shared.assetsHost}}/img/landing/new/dev-friendly/2.svg" alt="">
							
						<h6>Combine multiple<br> files on-demand</h6>
					</a></li>
					<li><a href="/features#minify">
						<img src="{{@shared.assetsHost}}/img/landing/new/dev-friendly/3.svg" alt="">
							
						<h6>Minify files on-demand</h6>
					</a></li>
					<li><a href="/features#combine">
						<img src="{{@shared.assetsHost}}/img/landing/new/dev-friendly/4.svg" alt="">
							
						<h6>Source map support</h6>
					</a></li>
					<li><a href="/features#alias">
						<img src="{{@shared.assetsHost}}/img/landing/new/dev-friendly/5.svg" alt="">
							
						<h6>Version aliasing</h6>
					</a></li>
					<li><a>
						<img src="{{@shared.assetsHost}}/img/landing/new/dev-friendly/6.svg" alt="">
							
						<h6>Multiple<br> IDE Integrations</h6>
					</a></li>
				</ul>
			</div>
		</div>
	</section>

	<section class="api section">
		<div class="container-lg flex">
			<div class="api-content">
				<h3>A free API for all NPM <br> and ESM needs</h3>
				<p>The official jsDelivr API allows you to get details about NPM packages like their files and versions. We intelligently guess the correct entrypoints and provide the CDN URLs with their hashes.</p>
				<p>Additionally you can get detailed download stats per project, per file and per version.</p>
	
				<a class="btn-arrow" href="">
					Read the API documentation
					<img src="{{@shared.assetsHost}}/img/icons/arrow-right.svg">
				</a>
			</div>
			
			<div class="api-code code">
				<div class="code-head">
					<span></span>
				</div>

				<div class="code-tabs flex">
					<a on-click="@this.set('activeTab', '')" class="{{#unless activeTab}}active{{/unless}}">
						Get project entrypoint
					</a>

					<a on-click="@this.set('activeTab', 'versions')" class="{{#if activeTab === 'versions'}}active{{/if}}">
						Get all versions
					</a>

					<a on-click="@this.set('activeTab', 'files')" class="{{#if activeTab === 'files'}}active{{/if}}">
						List package files
					</a>

					<div class="code-tabs-line" style="left: {{activeTabLineData[0]}}px; width: {{activeTabLineData[1]}}px;"></div>
				</div>
				
				<div class="code-slider">
					<c-slider active="{{activeSlide}}" direction="horizontal" distance="500">
						<c-slide>
							<div class="code-slide">
								<p class="code-link">https://data.jsdelivr.com/v1/package/npm/bootstrap@5.1.0/entrypoints</p>
								<p></p>
								<p>// =></p>
								<p>{</p>
								<p>"<span class="code-key">js</span>": {</p>
								<p>"<span class="code-key">file</span>": "<span class="code-string">/dist/js/bootstrap.min.js</span>",</p>
								<p>"<span class="code-key">guessed</span>": <span class="code-boolean">false</span></p>
								<p>},</p>
								<p>"<span class="code-key">css</span>": {</p>
								<p>"<span class="code-key">file</span>": "<span class="code-string">/dist/css/bootstrap.min.css</span>",</p>
								<p>"<span class="code-key">guessed</span>": <span class="code-boolean">false</span></p>
								<p>}</p>
								<p>},</p>
								<p>{</p>
								<p>"<span class="code-key">js</span>": {</p>
								<p>"<span class="code-key">file</span>": "<span class="code-string">/dist/js/bootstrap.min.js</span>",</p>
								<p>"<span class="code-key">guessed</span>": <span class="code-boolean">false</span></p>
								<p>},</p>
								<p>"<span class="code-key">css</span>": {</p>
								<p>"<span class="code-key">file</span>": "<span class="code-string">/dist/css/bootstrap.min.css</span>",</p>
								<p>"<span class="code-key">guessed</span>": <span class="code-boolean">false</span></p>
								<p>}</p>
								<p>},</p>
								<p>{</p>
								<p>"<span class="code-key">js</span>": {</p>
								<p>"<span class="code-key">file</span>": "<span class="code-string">/dist/js/bootstrap.min.js</span>",</p>
								<p>"<span class="code-key">guessed</span>": <span class="code-boolean">false</span></p>
								<p>},</p>
								<p>"<span class="code-key">css</span>": {</p>
								<p>"<span class="code-key">file</span>": "<span class="code-string">/dist/css/bootstrap.min.css</span>",</p>
								<p>"<span class="code-key">guessed</span>": <span class="code-boolean">false</span></p>
								<p>}</p>
								<p>},</p>
							</div>
						</c-slide>

						<c-slide>
							<div class="code-slide">
								<p class="code-link">https://data.jsdelivr.com/v1/package/npm/bootstrap@5.1.0/entrypoints</p>
								<p></p>
								<p>// =></p>
								<p>{</p>
								<p>"<span class="code-key">js</span>": {</p>
								<p>"<span class="code-key">file</span>": "<span class="code-string">/dist/js/bootstrap.min.js</span>",</p>
								<p>"<span class="code-key">guessed</span>": <span class="code-boolean">false</span></p>
								<p>},</p>
								<p>"<span class="code-key">css</span>": {</p>
								<p>"<span class="code-key">file</span>": "<span class="code-string">/dist/css/bootstrap.min.css</span>",</p>
								<p>"<span class="code-key">guessed</span>": <span class="code-boolean">false</span></p>
								<p>}</p>
							</div>
						</c-slide>

						<c-slide>
							<div class="code-slide">
								<p class="code-link">https://data.jsdelivr.com/v1/package/npm/bootstrap@5.1.0/entrypoints</p>
								<p></p>
								<p>// =></p>
								<p>{</p>
								<p>"<span class="code-key">js</span>": {</p>
								<p>"<span class="code-key">file</span>": "<span class="code-string">/dist/js/bootstrap.min.js</span>",</p>
								<p>"<span class="code-key">guessed</span>": <span class="code-boolean">false</span></p>
								<p>},</p>
								<p>"<span class="code-key">css</span>": {</p>
								<p>"<span class="code-key">file</span>": "<span class="code-string">/dist/css/bootstrap.min.css</span>",</p>
								<p>"<span class="code-key">guessed</span>": <span class="code-boolean">false</span></p>
								<p>}</p>
							</div>
						</c-slide>
					</c-slider>
				</div>
				
			</div>
		</div>
	</section>

	<c-new-infographic-banner></c-new-infographic-banner>

	<section class="js-modules api section">
		<div class="container-lg flex">
			<div class="js-modules-code api-code code">
				<div class="code-head">
					<span></span>
				</div>
			</div>

			<div class="js-modules-content api-content">
				<h3>A New-Age CDN for JavaScript modules</h3>
				<p>Load modern JavaScript packages built for you on-demand. <br>Works in modern web browsers, node.js, and deno</p>
				<ul class="checklist">
					<li>
						<img src="{{@shared.assetsHost}}/img/icons/check-circle.svg">
						
						Global Multi-CDN
					</li>
					<li>
						<img src="{{@shared.assetsHost}}/img/icons/check-circle.svg">

						HTTP/3, minification, Brotli compression, fine-tuned HTTP caching, dependency preloading
					</li>
					<li>
						<img src="{{@shared.assetsHost}}/img/icons/check-circle.svg">

						Permanent storage shared by all edge servers
					</li>
				</ul>
	
				<a class="btn-arrow" href="">
					Learn more about ESM
					<img src="{{@shared.assetsHost}}/img/icons/arrow-right.svg">
				</a>
			</div>

		</div>
	</section>

	
	<section class="top-packages top-packages-wrap section">
		<div class="container-lg flex">
			<div class="top-packages-title">
				<h5>Top 5 npm packages</h5>
				<span>last 30 days</span>
				<a class="btn-arrow" href="">
					See more stats
					<img src="{{@shared.assetsHost}}/img/icons/arrow-right.svg">
				</a>
			</div>

			<div class="top-packages-table">
				<c-stats-table title="Top 10 npm packages last 30 days" data="{{topPackages.slice(0, 5)}}">
					{{#partial column1}}
					<a href="/package/{{type}}/{{name}}"><span class="prefix">{{type}}/</span>{{name}}</a>
					{{/partial}}
				</c-stats-table>
			</div>
		</div>
	</section>

	<section class="top-packages endpoints section">
		<div class="container-lg flex">
			<div class="top-packages-table endpoints-flex">
				<div>
					<img src="{{@shared.assetsHost}}/img/landing/new/endpoint1.png">
					<p>406 745 962</p>
					<span>Requests Served last month</span>
					<p>52.3 GB</p>
					<span>Bandwidth last month</span>
				</div>
				<div>
					<img src="{{@shared.assetsHost}}/img/landing/new/endpoint2.png">
					<p>884 745 962</p>
					<span>Requests Served last month</span>
					<p>45.2 GB</p>
					<span>Bandwidth last month</span>
				</div>
				<div>
					<img src="{{@shared.assetsHost}}/img/landing/new/endpoint3.png">
					<p>28 745 962</p>
					<span>Requests Served last month</span>
					<p>34.5 GB</p>
					<span>Bandwidth last month</span>
				</div>
			</div>

			<div class="top-packages-title">
				<h5>Custom OSS Endpoints</h5>
				<span>jsDelivr is happy to support unique use-cases that require a fast CDN</span>
				<a class="btn-arrow" href="">
					Explore all custom endpoints
					<img src="{{@shared.assetsHost}}/img/icons/arrow-right.svg">
				</a>
			</div>
		</div>
	</section>

	<section class="top-packages section">
		<div class="container-lg flex">
			<div class="top-packages-title">
				<h5>jsDelivr is used by millions of websites globally</h5>

				<a class="btn-arrow" href="">
					Become a sponsor
					<img src="{{@shared.assetsHost}}/img/icons/arrow-right.svg">	
				</a>
			</div>

			<div class="top-packages-table">
				<img src="{{@shared.assetsHost}}/img/landing/new/used-by.svg">
			</div>
		</div>
	</section>

</div>

<script>
	const _ = require('../../public/js/_');
	const http = require('../../public/js/utils/http');
	const code_tabs = [ 'entrypoints', 'versions', 'files' ];

	component.exports = {
		computed: {
			activeTabLineData () {
				let activeSlideEl = document.querySelectorAll('.code-tabs a')[this.get('activeSlide') || 0];
				if(!activeSlideEl) return;

				return [activeSlideEl.offsetLeft, activeSlideEl.clientWidth];
			},
		},
		data () {
			return {
				_,
				activeTab: '',
			};
		},
		oninit () {
			this.findComponent('c-slider').set('active', code_tabs.indexOf(this.get('activeTab')) !== -1 ? code_tabs.indexOf(this.get('activeTab')) : 0);
			
			if (!Ractive.isServer) {
				this.observe('activeTab', (newValue) => {
					document.querySelector('.code-slider .c-slider').scrollTop = 0;
					this.findComponent('c-slider').show(code_tabs.indexOf(newValue) !== -1 ? code_tabs.indexOf(newValue) : 0);
				}, { init: false });

				// Load top packages.
				http.fetchTopPackages().then((data) => {
					this.set('topPackages', data);
				});

				// Load network stats for the previous day
				http.fetchNetworkStats('day').then((data) => {
					this.set('baseRequestsPerSecond', (data.hits.total / 24 / 60 / 60));
					this.set('baseBandwidth', 900)
				});

				let animationConfig = {
					duration: 1000, 
					easing: (x) => x === 1 ? 1 : 1 - Math.pow(2, -10 * x) 
				};

				setInterval(() => {
					let requestsPerSecond = this.getRandom(85, 115) / 100 * this.get('baseRequestsPerSecond'),
						bandwidth = this.getRandom(85, 115) / 100 * this.get('baseBandwidth');

					this.animate( 'requestsPerSecond', requestsPerSecond, animationConfig );
					this.animate( 'bandwidth', bandwidth, animationConfig );
				}, 2000);
			}
		},
		getRandom(min, max) {
			return Math.floor(Math.random() * (max - min + 1) + min);
		},
	};
</script>
